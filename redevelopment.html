<section class="odx-content-section odx-content-section--component-9">
    <!-- START: Ohio Design / Site Builder / Site Components Core / Filter / Resources / MAIN - Configurable Resources Filter -->
  
  <link href="/wps/wcm/connect/gov/cd674567-ec13-4131-8f4d-d5f6b97c5000/bootstrap-datepicker3.min.css?MOD=AJPERES&amp;CONVERT_TO=url&amp;CACHEID=ROOTWORKSPACE.Z18_JQGCH4S04P41206HNUKVF31000-cd674567-ec13-4131-8f4d-d5f6b97c5000-nUMnorZ" rel="stylesheet">
  <script src="/wps/wcm/connect/gov/b2f2f9ed-823e-4315-be9c-974ee86812e7/bootstrap-datepicker.min.js?MOD=AJPERES&amp;CONVERT_TO=url&amp;CACHEID=ROOTWORKSPACE.Z18_JQGCH4S04P41206HNUKVF31000-b2f2f9ed-823e-4315-be9c-974ee86812e7-nUMp13z"></script>
  
  <div class="iop-content-filter">
      <div id="resources-filter" class="iop-filter__container odx-topic-hub-resources__container margin-bottom-md componentContainer "><!-- START: Ohio Design / Content / Component Templates / Global / Filter / standard-filter.hbs.html -->
  <div class="iop-filter__first-section js-iop-filter__first-section" style="display: none;">
      <div class="iop-filter__title-container">
          <p class="iop-filter__help-text">Filter the content below by keyword or topic.</p>
          <span class="iop-filter__collapse-btn js-iop-collapse-btn">
              <i class="fa fa-chevron-down" aria-hidden="true"></i>
          </span>
      </div>
      <!-- START div from collapsible for mobile -->
      <div class="js-iop-hide-first-section-filters-mobile">
          <div class="iop-filter__input-container">
              <div class="">
                  <label for="iop-input-search" class="sr-only">Filter by keyword</label>
                  <input id="iop-input-search" class="js-iop-input iop-filter__input-filter hidden" type="text" placeholder="Type a Keyword here">
              </div>
          </div>
      </div>
      <!-- END div from collapsible for mobile -->
  </div>
  <div class="iop-filter__second-section js-iop-filter__second-section" style="border-top: 1px solid rgb(216, 216, 216); border-radius: 10px; display: none;">
      <div id="iop-filter-taxonomies-container" class="iop-filter__boxes-wrapper iop-filter__taxonomies-container componentContainer margin-bottom-sm">
      </div>
      <div class="iop-filter__result-and-buttons-wrapper">
          <div class="iop-filter__results-number-container">
              <div class="iop-filter__results-number js-iop-results-number"></div>
          </div>
          <div class="iop-filter__buttons-container">
              <button class="iop-filter__input-filter-btn btn btn-primary js-iop-filter-button">Filter</button>
              <button class="iop-filter__reset-btn btn js-iop-reset-button">Reset Filters</button>
          </div>
      </div>
  </div>
  <!-- END: Ohio Design / Content / Component Templates / Global / Filter / standard-filter.hbs.html -->
  <div id="cards-generic-wrapper" class="iop-filter__content componentContainer "><!-- START: Ohio Design / Content / Component Templates / Global / Filter / resource-cards.hbs.html -->
  <div class="core-resources__list">
      <div class="row list-unstyled js-iop-items-container">
          <div id="07dc3b0b-09bb-4fa3-b4dc-8503b10859ff" class="iop-filter-container__item-grid iop-filter-container--visible odx-carousel-cards-item ohio-cards-container-grid col-xs-12 col-sm-4 col-md-4 col-lg-3 js-iop-item js-iop-item--visible fist-item-in-page" data-page="1" data-column="" style="">
              <div class="ohio-card ohio-card--center">
                  <a class="ohio-card-wrapper-anchor" href="/wps/portal/gov/development/community/redevelopment/abandoned-gas-station-cleanup-grant">
                      <div class="ohio-card-bg">
                          <img class="ohio-card-bg-img" src="/wps/wcm/connect/gov/c16b0a74-7d22-495d-90b2-2acb04b3fd8d/abandonedgasstation.jpg?MOD=AJPERES&amp;amp;CACHEID=ROOTWORKSPACE.Z18_JQGCH4S04P41206HNUKVF31000-c16b0a74-7d22-495d-90b2-2acb04b3fd8d-oSzweDu" alt="old gas station site on E. 5th Street in Marysville for a new development">
                      </div>
                      <section class="ohio-card-content">
                          <h3 class="ohio-card-content-header js-iop-item-header">Abandoned Gas Station Cleanup Grant</h3>
                          <p class="ohio-card-content-summary">In partnership with Ohio EPA and the Department of Commerce, Bureau of Underground Storage Tank Regulations (BUSTR), Development helps clean up abandoned gas and service stations throughout Ohio.</p>
                      </section>
                  </a>
              </div>
          </div>
          <div id="865af2d8-372b-4860-9519-076ab53ab773" class="iop-filter-container__item-grid iop-filter-container--visible odx-carousel-cards-item ohio-cards-container-grid col-xs-12 col-sm-4 col-md-4 col-lg-3 js-iop-item js-iop-item--visible" data-page="1" data-column="" style="">
              <div class="ohio-card ohio-card--center">
                  <a class="ohio-card-wrapper-anchor" href="/wps/portal/gov/development/community/redevelopment/advanced-energy-fund-grant">
                      <div class="ohio-card-bg">
                          <img class="ohio-card-bg-img" src="/wps/wcm/connect/gov/ba8ff953-e161-4e45-8455-fe93b2c29ccc/energy_thumb.png?MOD=AJPERES&amp;amp;CACHEID=ROOTWORKSPACE.Z18_JQGCH4S04P41206HNUKVF31000-ba8ff953-e161-4e45-8455-fe93b2c29ccc-pkpo6nI" alt="">
                      </div>
                      <section class="ohio-card-content">
                          <h3 class="ohio-card-content-header js-iop-item-header">Advanced Energy Fund Grant</h3>
                          <p class="ohio-card-content-summary">Provides grant funds for Ohio organizations to complete energy efficiency and advanced energy projects.</p>
                      </section>
                  </a>
              </div>
          </div>
          <div id="ef25fbd7-072f-4028-9234-be1f0f905d5d" class="iop-filter-container__item-grid iop-filter-container--visible odx-carousel-cards-item ohio-cards-container-grid col-xs-12 col-sm-4 col-md-4 col-lg-3 js-iop-item js-iop-item--visible" data-page="1" data-column="" style="">
              <div class="ohio-card ohio-card--center">
                  <a class="ohio-card-wrapper-anchor" href="/wps/portal/gov/development/community/redevelopment/brightening-ohio-communities">
                      <div class="ohio-card-bg">
                          <img class="ohio-card-bg-img" src="/wps/wcm/connect/gov/bf15babe-4c80-4c7c-bab4-839e8aa08503/boc_thumb.png?MOD=AJPERES&amp;amp;CACHEID=ROOTWORKSPACE.Z18_JQGCH4S04P41206HNUKVF31000-bf15babe-4c80-4c7c-bab4-839e8aa08503-p5cwcZq" alt="">
                      </div>
                      <section class="ohio-card-content">
                          <h3 class="ohio-card-content-header js-iop-item-header">Brightening Ohio Communities</h3>
                          <p class="ohio-card-content-summary">Provides grants to implement cost-effective, energy efficiency improvements for streetlights, perimeter lighting, and municipal-owned parking lot lighting in communities across Ohio.</p>
                      </section>
                  </a>
              </div>
          </div>
          <div id="37a15149-bec2-45aa-a05c-204a5d0ef1c9" class="iop-filter-container__item-grid iop-filter-container--visible odx-carousel-cards-item ohio-cards-container-grid col-xs-12 col-sm-4 col-md-4 col-lg-3 js-iop-item js-iop-item--visible" data-page="1" data-column="" style="">
              <div class="ohio-card ohio-card--center">
                  <a class="ohio-card-wrapper-anchor" href="/wps/portal/gov/development/community/redevelopment/brownfield-remediation-program">
                      <div class="ohio-card-bg">
                          <img class="ohio-card-bg-img" src="/wps/wcm/connect/gov/5f258d48-737d-4e5d-bcba-4718f0614165/400x300Cleveland-Metropolitan-School-District-Building-Exterior-20.jpg?MOD=AJPERES&amp;amp;CACHEID=ROOTWORKSPACE.Z18_JQGCH4S04P41206HNUKVF31000-5f258d48-737d-4e5d-bcba-4718f0614165-pkv3cAB" alt="Cleveland Metropolitan School District Building Exterior Remediation">
                      </div>
                      <section class="ohio-card-content">
                          <h3 class="ohio-card-content-header js-iop-item-header">Brownfield Remediation Program</h3>
                          <p class="ohio-card-content-summary">This program is designed to provide grants for the remediation of brownfield sites across Ohio to clean up the sites and prepare them for future economic development.</p>
                      </section>
                  </a>
              </div>
          </div>
          <div id="d7d37be3-fdd4-4eb1-876a-85ac54fe33ac" class="iop-filter-container__item-grid iop-filter-container--visible odx-carousel-cards-item ohio-cards-container-grid col-xs-12 col-sm-4 col-md-4 col-lg-3 js-iop-item js-iop-item--visible" data-page="1" data-column="" style="">
              <div class="ohio-card ohio-card--center">
                  <a class="ohio-card-wrapper-anchor" href="/wps/portal/gov/development/community/redevelopment/building-demolition-site-revitalization-program">
                      <div class="ohio-card-bg">
                          <img class="ohio-card-bg-img" src="/wps/wcm/connect/gov/9bc64aee-fd43-4be4-b768-4328111f137b/400x300-Excavator-at-construction-site-on-sunset-background.jpg?MOD=AJPERES&amp;amp;CACHEID=ROOTWORKSPACE.Z18_JQGCH4S04P41206HNUKVF31000-9bc64aee-fd43-4be4-b768-4328111f137b-paVGw5q" alt="Excavator at construction site on sunset background">
                      </div>
                      <section class="ohio-card-content">
                          <h3 class="ohio-card-content-header js-iop-item-header">Building Demolition and Site Revitalization Program</h3>
                          <p class="ohio-card-content-summary">This program is designed to provide grants for the demolition of commercial and residential buildings and revitalization of surrounding properties.</p>
                      </section>
                  </a>
              </div>
          </div>
          <div id="5c3004b2-5582-4b53-8a1a-c8e74e134fcf" class="iop-filter-container__item-grid iop-filter-container--visible odx-carousel-cards-item ohio-cards-container-grid col-xs-12 col-sm-4 col-md-4 col-lg-3 js-iop-item js-iop-item--visible" data-page="1" data-column="" style="">
              <div class="ohio-card ohio-card--center">
                  <a class="ohio-card-wrapper-anchor" href="/wps/portal/gov/development/community/redevelopment/energy-loan-fund">
                      <div class="ohio-card-bg">
                          <img class="ohio-card-bg-img" src="/wps/wcm/connect/gov/4b5ceaf6-4853-4370-9b80-1fefa3b90b30/400x300-card-energy-loan-fund.jpg?MOD=AJPERES&amp;amp;CACHEID=ROOTWORKSPACE.Z18_JQGCH4S04P41206HNUKVF31000-4b5ceaf6-4853-4370-9b80-1fefa3b90b30-phC1P-F" alt="guy working on an electrical box for a business">
                      </div>
                      <section class="ohio-card-content">
                          <h3 class="ohio-card-content-header js-iop-item-header">Energy Loan Fund</h3>
                          <p class="ohio-card-content-summary">Through the Energy Loan Fund eligible applicants receive low-interest financing to install efficiency measures that reduce energy by at least 15%.</p>
                      </section>
                  </a>
              </div>
          </div>
          <div id="c5c721fd-a3c8-4187-8426-a5805e9d74ef" class="iop-filter-container__item-grid iop-filter-container--visible odx-carousel-cards-item ohio-cards-container-grid col-xs-12 col-sm-4 col-md-4 col-lg-3 js-iop-item js-iop-item--visible" data-page="1" data-column="" style="">
              <div class="ohio-card ohio-card--center">
                  <a class="ohio-card-wrapper-anchor" href="/wps/portal/gov/development/community/redevelopment/historic-preservation-pipeline">
                      <div class="ohio-card-bg">
                          <img class="ohio-card-bg-img" src="/wps/wcm/connect/gov/dd10b990-fcd8-42e7-85b9-8d3fc7aef4b5/hpp-thumb.png?MOD=AJPERES&amp;amp;CACHEID=ROOTWORKSPACE.Z18_JQGCH4S04P41206HNUKVF31000-dd10b990-fcd8-42e7-85b9-8d3fc7aef4b5-p1KGe5I" alt="">
                      </div>
                      <section class="ohio-card-content">
                          <h3 class="ohio-card-content-header js-iop-item-header">Historic Preservation Pipeline Initiative</h3>
                          <p class="ohio-card-content-summary">Provides small grants and technical assistance to assist in nominating buildings and districts to the National Register of Historic Places</p>
                      </section>
                  </a>
              </div>
          </div>
          <div id="a874df99-0034-493a-bb56-be0d65a41e1f" class="iop-filter-container__item-grid iop-filter-container--visible odx-carousel-cards-item ohio-cards-container-grid col-xs-12 col-sm-4 col-md-4 col-lg-3 js-iop-item js-iop-item--visible" data-page="1" data-column="" style="">
              <div class="ohio-card ohio-card--center">
                  <a class="ohio-card-wrapper-anchor" href="/wps/portal/gov/development/community/redevelopment/loan-loss-reserve-program">
                      <div class="ohio-card-bg">
                          <img class="ohio-card-bg-img" src="/wps/wcm/connect/gov/c2eea939-0dd8-4fed-9605-5f6543137594/400x300-card-loan-loss-program.jpg?MOD=AJPERES&amp;amp;CACHEID=ROOTWORKSPACE.Z18_JQGCH4S04P41206HNUKVF31000-c2eea939-0dd8-4fed-9605-5f6543137594-n-TrCJx" alt="a black guy and a white guy electrician working on a panel">
                      </div>
                      <section class="ohio-card-content">
                          <h3 class="ohio-card-content-header js-iop-item-header">Loan Loss Reserve Program</h3>
                          <p class="ohio-card-content-summary">The Loan Loss Reserve program offers credit enhancement of up to 50% of a qualified energy efficiency project on an existing structure.</p>
                      </section>
                  </a>
              </div>
          </div>
          <div id="1d7b4513-699b-4be5-8cca-65ffd818e967" class="iop-filter-container__item-grid iop-filter-container--visible odx-carousel-cards-item ohio-cards-container-grid col-xs-12 col-sm-4 col-md-4 col-lg-3 js-iop-item js-iop-item--visible" data-page="1" data-column="" style="">
              <div class="ohio-card ohio-card--center">
                  <a class="ohio-card-wrapper-anchor" href="/wps/portal/gov/development/community/redevelopment/ohio-historic-preservation-tax-credit-program">
                      <div class="ohio-card-bg">
                          <img class="ohio-card-bg-img" src="/wps/wcm/connect/gov/7a215fe0-35bc-4733-9075-1936b382b687/400x300-card-arcade.jpg?MOD=AJPERES&amp;amp;CACHEID=ROOTWORKSPACE.Z18_JQGCH4S04P41206HNUKVF31000-7a215fe0-35bc-4733-9075-1936b382b687-pnNw6Qc" alt="Dayton Arcade historic building">
                      </div>
                      <section class="ohio-card-content">
                          <h3 class="ohio-card-content-header js-iop-item-header">Ohio Historic Preservation Tax Credit Program</h3>
                          <p class="ohio-card-content-summary">The Ohio Historic Preservation Tax Credit Program provides a tax credit to leverage the private redevelopment of historic buildings</p>
                      </section>
                  </a>
              </div>
          </div>
          <div id="a07967d0-d7ae-4438-9cfe-9a564824420c" class="iop-filter-container__item-grid iop-filter-container--visible odx-carousel-cards-item ohio-cards-container-grid col-xs-12 col-sm-4 col-md-4 col-lg-3 js-iop-item js-iop-item--visible" data-page="1" data-column="" style="">
              <div class="ohio-card ohio-card--center">
                  <a class="ohio-card-wrapper-anchor" href="/wps/portal/gov/development/community/redevelopment/reduction-household-energy-burden">
                      <div class="ohio-card-bg">
                          <img class="ohio-card-bg-img" src="/wps/wcm/connect/gov/ac52adc3-7cf0-4c67-aecf-ad67dd8929a8/_Cheerful-man-set-the-thermostat-at-house.jpg?MOD=AJPERES&amp;amp;CACHEID=ROOTWORKSPACE.Z18_JQGCH4S04P41206HNUKVF31000-ac52adc3-7cf0-4c67-aecf-ad67dd8929a8-ofmG7tr" alt="Cheerful man set the thermostat at house">
                      </div>
                      <section class="ohio-card-content">
                          <h3 class="ohio-card-content-header js-iop-item-header">Reduction in Household Energy Burden</h3>
                          <p class="ohio-card-content-summary">This program provides funding to develop programs that reduce energy use for Ohioans eligible for the Energy Assistance Programs.</p>
                      </section>
                  </a>
              </div>
          </div>
          <div id="060750bd-5a73-4075-a7b0-dd8f634f1775" class="iop-filter-container__item-grid iop-filter-container--visible odx-carousel-cards-item ohio-cards-container-grid col-xs-12 col-sm-4 col-md-4 col-lg-3 js-iop-item js-iop-item--visible" data-page="1" data-column="" style="">
              <div class="ohio-card ohio-card--center">
                  <a class="ohio-card-wrapper-anchor" href="https://www.jobsohio.com/sites/" target="">
                      <div class="ohio-card-bg">
                          <img class="ohio-card-bg-img" src="/wps/wcm/connect/gov/6c507deb-81f3-4835-b354-9a460bc9915b/400x300-card-SiteOhio1.jpg?MOD=AJPERES&amp;amp;CACHEID=ROOTWORKSPACE.Z18_JQGCH4S04P41206HNUKVF31000-6c507deb-81f3-4835-b354-9a460bc9915b-nDnSYfC" alt="NextEdge Research &amp; Technology Park overview shot of land - SiteOhio">
                      </div>
                      <section class="ohio-card-content">
                          <h3 class="ohio-card-content-header js-iop-item-header">SiteOhio</h3>
                          <p class="ohio-card-content-summary">SiteOhio is a site selection evaluation program that goes beyond the common site certification process.</p>
                      </section>
                  </a>
              </div>
          </div>
          <div id="3e7c3a9e-7cab-441e-b7fb-1bff377a4985" class="iop-filter-container__item-grid iop-filter-container--visible odx-carousel-cards-item ohio-cards-container-grid col-xs-12 col-sm-4 col-md-4 col-lg-3 js-iop-item js-iop-item--visible last-item-in-page" data-page="1" data-column="" style="">
              <div class="ohio-card ohio-card--center">
                  <a class="ohio-card-wrapper-anchor" href="/wps/portal/gov/development/community/redevelopment/state-energy-program">
                      <div class="ohio-card-bg">
                          <img class="ohio-card-bg-img" src="/wps/wcm/connect/gov/96191d8d-df3e-4989-ac72-26523da9d64a/hvac-400x300.jpg?MOD=AJPERES&amp;amp;CACHEID=ROOTWORKSPACE.Z18_JQGCH4S04P41206HNUKVF31000-96191d8d-df3e-4989-ac72-26523da9d64a-pnj-soG" alt="overview of school classroom">
                      </div>
                      <section class="ohio-card-content">
                          <h3 class="ohio-card-content-header js-iop-item-header">State Energy Program</h3>
                          <p class="ohio-card-content-summary">Helps Ohioans implement energy efficiency improvements to lower energy use and costs.</p>
                      </section>
                  </a>
              </div>
          </div>
          <div id="03da0217-febe-4200-9605-08ff42265524" class="iop-filter-container__item-grid iop-filter-container--visible odx-carousel-cards-item ohio-cards-container-grid col-xs-12 col-sm-4 col-md-4 col-lg-3 js-iop-item js-iop-item--visible fist-item-in-page last-item-in-page" data-page="2" data-column="" style="display: none;">
              <div class="ohio-card ohio-card--center">
                  <a class="ohio-card-wrapper-anchor" href="/wps/portal/gov/development/community/redevelopment/welcomehome">
                      <div class="ohio-card-bg">
                          <img class="ohio-card-bg-img" src="/wps/wcm/connect/gov/10f609c1-4ce9-4daf-b416-f1a619e70f1c/welcomehomeohio400x300.jpg?MOD=AJPERES&amp;amp;CACHEID=ROOTWORKSPACE.Z18_JQGCH4S04P41206HNUKVF31000-10f609c1-4ce9-4daf-b416-f1a619e70f1c-plOzGqR" alt="">
                      </div>
                      <section class="ohio-card-content">
                          <h3 class="ohio-card-content-header js-iop-item-header">Welcome Home Ohio Program</h3>
                          <p class="ohio-card-content-summary">The Welcome Home Ohio (WHO) program is designed to provide grants for the purchase of qualifying residential properties, the cost of construction or rehabilitation, or a nonrefundable tax credit for qualifying activities.</p>
                      </section>
                  </a>
              </div>
          </div>
          <div class="iop-filter__content-no-results js-iop-image-no-results js-no-results-img" style="display: none;">
              <img src="/wps/wcm/connect/gov/222eff35-ce11-4203-b24c-f8dc2e31e9d1/content-not-found_blue.png?MOD=AJPERES&amp;CACHEID=ROOTWORKSPACE.Z18_JQGCH4S04P41206HNUKVF31000-222eff35-ce11-4203-b24c-f8dc2e31e9d1-nFDz1TL" alt="No results for filter search">
              <p class="odx-card-no-result__message odx-bold">Your filter did not match any results.</p>
          </div>
      </div>
  </div>
  <ul class="odx-events__search-pagination pagination-sm pagination js-iop-filter-pagination"><li class="page-item prev disabled"><a href="#" class="page-link" aria-label="Previous page"><i class="fa fa-caret-left"></i></a></li><li class="page-item active"><a href="#" class="page-link" aria-label="Page Number 1">1</a></li><li class="page-item"><a href="#" class="page-link" aria-label="Page Number 2">2</a></li><li class="page-item next"><a href="#" class="page-link" aria-label="Next page"><i class="fa fa-caret-right"></i></a></li></ul>
  <!-- END: Ohio Design / Content / Component Templates / Global / Filter / resource-cards.hbs.html --></div></div>
  </div>
  
  <script>
  /* START: Ohio Design > Components > Site Builder > Site Components Core > Filter > Dependencies > JS - Content With Filters */
  (function(){
      var DefaultOptions = {
          Environment: {
              wcmLibraryLanguage: 'en',
              context: 'gov'
          },
          AjaxParameters: {
              source: 'library',
              srv: 'cmpnt',
              cmpntid: 'aa7a4aa9-f871-4f6e-a646-3b6a162a51dd'
          }
      };
  
      //Logic part from component, gets the data to fill the cards
      window.MultipleFilters = function( wcmComponent ) {
  
          //var LocalOptions = Options || DefaultOptions;
          var LocalOptions = DefaultOptions;
  
          if ( typeof wcmComponent === "object" && wcmComponent.id ) {
              LocalOptions.AjaxParameters.cmpntid = wcmComponent.id;
              if ( wcmComponent.location ) {
                  LocalOptions.AjaxParameters.location = wcmComponent.location;
              }
              if ( wcmComponent.category ) {
                  LocalOptions.AjaxParameters.category = wcmComponent.category;
              }
          }
  
          var Utils = {
              prepareLibrary: function(){
                  // 1) Get all variables to support multilingual content
                  var currentLanguage = OHIO.ODX.actions.getUserLanguageByCookie();
                  // Get the library according to the user's language
                  var wcmLibrary = (typeof window.WCMLibraries !== "undefined") ? window.WCMLibraries[currentLanguage] : window.WCMLibraries[ LocalOptions.Environment.wcmLibraryLanguage ];
                  var virtualPortal = (window.portalContext !== 'none') ? window.portalContext + '/' : LocalOptions.Environment.context;
                  var currentCluster = '';
                  var urlString = window.location.href;
                  var urlArray = urlString.split('/');
                  var index = urlArray.indexOf(window.siteId);
                  if (index > 0 && urlArray[index]) {
                      currentCluster = urlArray[index + 1];
                  }
  
                  var currentPathArray = decodeURIComponent("/Ohio Content English/development/community/redevelopment").split("/");
                  var location = "";
                  var length = currentPathArray.length;
                  currentPathArray.forEach(function (element, index) {
                      if (index > 1) {
                          location += "/" + element;
                      }
                  });
  
                  var LibrarySettings = {
                      virtualPortal: virtualPortal,
                      wcmLibrary: wcmLibrary,
                      location: location
                  };
  
                  return LibrarySettings;
              },
              configureAjaxParameters: function(){
                  var LibrarySettings = this.prepareLibrary();
                  // 2) Configure parameters for AJAX call
                  var Params = {
                      source: LocalOptions.AjaxParameters.source,
                      srv: LocalOptions.AjaxParameters.srv,
                      cmpntid: LocalOptions.AjaxParameters.cmpntid,
                      location: LocalOptions.AjaxParameters.location ? LocalOptions.AjaxParameters.location : LibrarySettings.wcmLibrary + '/' + LibrarySettings.location,
                      category: LocalOptions.AjaxParameters.category ? LocalOptions.AjaxParameters.category : ''
                  };
  
                  var serviceURL = '/wps/wcm/connect/' + LibrarySettings.virtualPortal + LibrarySettings.wcmLibrary + '/' + window.siteId + '?' + $.param(Params);
                  return serviceURL;
              },
              generatePieceId: function(){
                  function s4() {
                      return Math.floor( (1 + Math.random()) * 0x10000 ).toString( 16 ).substring( 1 );
                  }
  
                  return 'b' + s4() + s4() + "-" + s4() + "-" + s4() + "-" + s4() + "-" + s4() + s4() + s4();
              },
              removeDuplicated: function( array ) {
                  return array.filter( function( a, b ){
                      return array.indexOf( a ) === b;
                  } );
              },
              removeDuplicatedIndex: function( items ){
                  var noRepeatedLetter = '';
                  if ( items.length > 1 ) {
                      for (var i = 1; i < items.length; i++) {
                          if ( items[i].hasOwnProperty('index') ) {
                              var currItemIndex = items[i].index;
                              if(items[i-1].hasOwnProperty('index')) {
                                  var prevItemIndex = items[i-1].index;
                                  if ( currItemIndex === prevItemIndex ) {
                                      noRepeatedLetter = currItemIndex;
                                      delete items[i].index;
                                  }
                              } else {
                                  if ( noRepeatedLetter === currItemIndex )
                                      delete items[i].index;
                              }
                          }
                      }
                      return items;
                  } else {
                      return items;
                  }
              }
          };
          return {
              AllItems: undefined,
              FilteredItems: undefined,
              CacheItems: undefined,
              hasItemAnyofTheseValues: function(itemValues, toSearchValues){
                  var categories = itemValues.split(",");
  
                  for( var i = 0; i < toSearchValues.length; i++ ) {
                      if ( categories.indexOf( toSearchValues[i] ) > -1 ) {
                          return true;
                      }
                  }
  
                  return false;
              },
              filterAction: function( FilterSelected, otherFiltersClicked ){
                  /*
                  FilterSelected = [
                      {
                          name: "county",
                          value: ["Orange", "Adams"]
                      },
                      {
                          name: "topic",
                          value: ["Aircraft, Allen"]
                      }
                  ]
                   */
  
                  var _this = this;
                  var FoundItems = [];
  
                  if ( otherFiltersClicked ) {
                      if ( this.FilteredItems.length == 0 ) {
                          this.FilteredItems = this.CacheItems;
                      }
                  }
  
                  FoundItems = this.FilteredItems = this.AllItems.filter( function( Item ){
                      for( var i=0; i < FilterSelected.length; i++) {
                          var itemValues = Item[ FilterSelected[i].name];
                          var toSearchValues = FilterSelected[i].value;
                          var hasAvalidValue = _this.hasItemAnyofTheseValues( itemValues , toSearchValues );
                          if ( !hasAvalidValue ) {/* Item did not approved first filter */
                              break;
                          }
                          if ( i === FilterSelected.length - 1 )/*If item has approved all filters, then the Item was found*/
                              return Item;
                      }
                  } );
  
                  if ( FoundItems.length == 0 ) {
                      this.CacheItems = this.FilteredItems.length == 0 ? this.AllItems : this.FilteredItems;
                  }
  
                  this.FilteredItems = this.AllItems.slice();
                  this.FilteredItems = FoundItems;
  
                  console.log( "Results from filter: ", this.FilteredItems );
  
  
                  return this.FilteredItems;
              },
              sortAction: function( Sorting, sortAllItems ){
                  var SortedItems = [];
                  if ( sortAllItems && sortAllItems === true ) {
  
                      this.FilteredItems = this.AllItems.slice();
  
                      var UnsortedItems = this.FilteredItems.slice();
  
                      Sorting.forEach( function( SortObj ) {
                          SortedItems = SortObj.sortInst( UnsortedItems );
                          UnsortedItems = SortedItems;
                      } );
  
                      if ( SortedItems !== undefined )
                          this.FilteredItems =  SortedItems.slice();
  
                      if ( Sorting.length === 0 ) {
                          this.FilteredItems = this.AllItems;
                      }
  
                  } else {
                      var UnsortedItems = this.FilteredItems.slice();
  
                      Sorting.forEach( function( SortObj ) {
                          SortedItems = SortObj.sortInst( UnsortedItems );
                          UnsortedItems = SortedItems;
                      } );
  
                      if ( SortedItems !== undefined )
                          this.FilteredItems =  SortedItems.slice();
                  }
  
                  console.log( "Results sorted: ", this.FilteredItems );
  
                  return this.FilteredItems;
  
              },
              filterByKeyword: function( keyword, Filters, noFiltersApplied ){
                  var FoundItems = [];
  
                  var categories = Filters.map( function( Filter ) {
                      return Filter.propertyName;
                  } );
  
                  if ( noFiltersApplied ) {
                      if ( this.FilteredItems.length == 0 ) {
                          this.FilteredItems = this.CacheItems;
                      }
                  }
  
                  if ( noFiltersApplied && noFiltersApplied === true ) {
                      this.FilteredItems = this.AllItems.slice();
                      FoundItems = this.FilteredItems = this.searchTerms( this.FilteredItems,  keyword.toLowerCase(), categories );
                  } else {
                      FoundItems = this.FilteredItems = this.searchTerms( this.FilteredItems, keyword.toLowerCase(), categories );
                  }
  
                  if ( FoundItems.length == 0 ) {
                      this.CacheItems = this.FilteredItems.length == 0 ? this.AllItems : this.FilteredItems;
                  }
  
                  this.FilteredItems = this.AllItems.slice();
                  this.FilteredItems = FoundItems;
  
                  console.log( "Results found by keyword: ", FoundItems );
  
                  return FoundItems;
              },
              searchTerms: function( Items, keyword, categories ){
                  var _this = this;
  
                  var FoundItems = Items.map(function( Item ){
                      var title = Item.title.toLowerCase();
                      var summary = Item.summary.toLowerCase();
                      title = title + summary;
                      if (title.indexOf(keyword)>=0)
                          return Item;
                  }).filter(function( Item ){
                      return Item !== undefined;
                  });
  
                  return FoundItems;
              },
              filterByDate: function( startTimeInput, endTimeInput, noFiltersApplied ){
                  var FoundItems = [];
  
                  if ( noFiltersApplied ) {
                      if ( this.FilteredItems.length == 0 ) {
                          this.FilteredItems = this.CacheItems;
                      }
                  }
  
                  if ( noFiltersApplied ) {
                      this.FilteredItems = this.AllItems.slice();
                      FoundItems = this.FilteredItems = this.searchEventWithDate( this.FilteredItems,  startTimeInput, endTimeInput );
                  } else {
                      FoundItems = this.FilteredItems = this.searchEventWithDate( this.FilteredItems, startTimeInput, endTimeInput );
                  }
  
                  if ( noFiltersApplied ) {
                      if ( this.FilteredItems.length == 0 ) {
                          this.FilteredItems = this.CacheItems;
                          this.FilteredItems = this.AllItems.slice();
                      }
                  }
  
                  this.FilteredItems = FoundItems;
  
                  console.log( "Results found by date: ", FoundItems );
  
                  return FoundItems;
  
              },
              searchEventWithDate: function( Events, startTimeInput, endTimeInput ) {
                  var FoundEvents = Events.map( function( Event ){
                      var startTime = new Date ( Event.startTimeWCM ),
                          endTime = new Date ( Event.endTimeWCM );
                      //Event happens in between the Date Range
                      if ( startTime >= startTimeInput && endTime <= endTimeInput ) {
                          return Event;
                      }
                      //Event starts before Date Range Start but ends before Date Range End
                      if ( endTime >= startTimeInput && endTime <= endTimeInput ) {
                          return Event;
                      }
                      //Event starts after Date Start Range but ends after Date Range End
                      if ( startTime >= startTimeInput && startTime <= endTimeInput ) {
                          return Event;
                      }
                      //Event begins before Date Range Start and finishes after Date Range End
                      if ( startTimeInput > startTime && endTimeInput < endTime ) {
                          return Event;
                      }
  
                  } ).filter(function( Item ){
                      return Item !== undefined;
                  });
  
                  return FoundEvents;
              },
              filterCustom: function( filterFn ){
                  var FoundItems = filterFn( this.FilteredItems );
                  return FoundItems;
              },
              getCategoriesFromItem: function( Item, categories ){
                  var allCategoriesFromItem = "";
  
                  categories.forEach( function( category ) {
                      allCategoriesFromItem = allCategoriesFromItem + Item[category];
                  } );
  
                  return allCategoriesFromItem.toLowerCase();
              },
              resetFilters: function(){
                  this.FilteredItems = this.CacheItems = this.AllItems;
                  return this.FilteredItems;
              },
              getOptionsFromContentToFillDropdown: function( propertyName ){
  
                  var dropdownOptions = this.AllItems.map( function( Item ){
                      if( Item.hasOwnProperty(propertyName) ) {
                          return Item[propertyName];
                      }
                  } );
                  var items = dropdownOptions.map( function(item){
                      return item.split(",");
                  } );
  
                  var preCategories = items.join();
                  var categories = preCategories.split(",");
  
                  var dropdownCleaned = Utils.removeDuplicated( categories ).filter( function( category ){ 
                      return category !== "";
                  } );
                  return dropdownCleaned.sort();
              },
              preProcessFilters: function( Filters ){
                  var _this = this;
  
                  var numberOfFilters = Filters.length;
                  var numberOfColumns;
  
                  switch( numberOfFilters ) {
                      case 3:
                          numberOfColumns = 4;
                          break;
                      case 2:
                          numberOfColumns = 6;
                          break;
                      default:
                          numberOfColumns = 12;
                  }
  
                  var FiltersWithColumnsAndOptions = Filters.map(function( Item ){
                      if ( Item.hasOwnProperty("options") ) {
                          Item.id = Item.id.substr(0,1 ) === "#" ? Item.id.substr(1) : Item.id;
                          Item.options = Item.options.sort();
                          Item.numColumns = numberOfColumns;
                          return Item;
                      } else if (Item.hasOwnProperty("keywordOnly")) {
                          Item.numColumns = numberOfColumns;
                          return Item;
                      } else {
                          Item.id = Item.id.substr(0,1 ) === "#" ? Item.id.substr(1) : Item.id;
                          Item.options = _this.getOptionsFromContentToFillDropdown( Item.propertyName );
                          Item.numColumns = numberOfColumns;
                          return Item;
                      }
                  });
  
                  return FiltersWithColumnsAndOptions;
              },
              sortByDateForEventsTypeContentOnly: function( a, b ){
                  var aDate = new Date( a.startTimeWCM );
                  var bDate = new Date( b.startTimeWCM );
                  return ((aDate < bDate) ? -1 : ((aDate > bDate) ? 1 : 0));
              },
              removeCurrentContentPiece: function( ContentPieces ){
                  //Remove content piece from where the filter is being referenced
  
                  var indexOfItemToRemove;
  
                  for( var i = 0; i < ContentPieces.length; i++ ){
                      if ( ContentPieces[i].uuid === '1bf78910-21db-47a8-aa69-d2184e9c33a6' ){
                          indexOfItemToRemove = i;
                          break;
                      }
                  }
  
                  if (  indexOfItemToRemove || indexOfItemToRemove === 0 ) {
                      ContentPieces.splice( indexOfItemToRemove, 1 );
                  }
              },
              getContentPiecesData: function( mappingFunction, elasticSearchQuery, sortByDate ){
                  var _this = this;
                  var serviceURL = Utils.configureAjaxParameters();
                  if ( elasticSearchQuery ) {
                      return elasticSearchUtils.findContent( elasticSearchQuery ).then(
                          function( response ) {
                              var ContentPieces = response.filter( function( Item ){
                                  if ( ! Item.hasOwnProperty('uuid') ) {
                                      Item.uuid = Utils.generatePieceId();
                                  }
                                  return Item;
                              } );
          
                              _this.removeCurrentContentPiece( ContentPieces );
  
                              if(ContentPieces) {
                                ContentPieces.forEach(function(dataElement) {
                                  if(dataElement.thumbnail) {
                                    dataElement.thumbnail = dataElement.thumbnail.replace('myconnect', 'connect');
                                  }
                                });
                              }
          
                              if ( mappingFunction ) {
                                  ContentPieces = mappingFunction( ContentPieces );
                              }
          
                              if ( sortByDate ) {
                                  ContentPieces = ContentPieces.sort(_this.sortByDateForEventsTypeContentOnly);
                              }
          
                              return _this.AllItems = _this.FilteredItems = ContentPieces;
                          },
                          function( error ){
                              console.log( error );
                          }
                      );
                  } else {
                      return OHIO.ODX.actions.getAjaxDataFromURL(serviceURL).then(function( response ){
                          var resources = JSON.parse(response);
                          var ContentPieces = resources.filter( function( Item ){
                              if ( ! Item.hasOwnProperty('uuid') ) {
                                  Item.uuid = Utils.generatePieceId();
                              }
                              return Item;
                          } );
      
                          _this.removeCurrentContentPiece( ContentPieces );
      
                          if ( mappingFunction ) {
                              ContentPieces = mappingFunction( ContentPieces );
                          }
      
                          if ( sortByDate ) {
                              ContentPieces = ContentPieces.sort(_this.sortByDateForEventsTypeContentOnly);
                          }
      
                          return _this.AllItems = _this.FilteredItems = ContentPieces;
                      },function( error ){
                          console.error(error);
                      });
                  }
                  
              },
              start: function(){
                  var _this = this;
                  return this.getContentPiecesData().then(function( response ){
                      console.log(response);
                      var filterOne = {
                          name: "county",
                          value: "Allen"
                      };
  
                      var filterTwo = {
                          name: "topics",
                          value: "Aircraft"
                      };
  
                      _this.filterAction( filterOne );
                      _this.filterAction( filterTwo );
                  });
              }
          };
      };
  
      //UI part
      window.FiltersWidget = function( componentID ){
  
          var Utils  = {
              inject: function( path, fallback ) {
                  try {
                      return eval( 'window.' + path );
                  } catch( e ) {
                      console.warn( 'Dependency not found: ', path );
                      return fallback;
                  }
              }
          };
  
          var OhioToolkitWebComponent = Utils.inject('OhioToolkit.components.WebComponent', console.log );
          var MultipleFiltersDataLogic = Utils.inject('MultipleFilters(componentID)', console.log );
          var FormioInstance = Utils.inject('Formio', console.log );
  
          var Instance = {
              elements: {},
              FilterInitialSettings: undefined,
              DropDownOptions: undefined,
              WidgetSettings: undefined,
              Filters: undefined,
              OtherFiltersClicked: 0,
              FiltersInDropdownClicked: [],
              SortingClicked: [],
              multipleLettersClicked: [],
              totalResources: undefined,
              setElements: function(){
                  var els = this.elements;
                  var idRoot = this.WidgetSettings.root;
  
                  els.$root = $( idRoot ) || $emptyDiv;//'#opd-filter'
  
                  els.input = els.$root.find('.js-iop-input');
                  els.searchButton = els.$root.find('.js-iop-filter-button');
  
                  var $cards = els.$root.find('.js-iop-items-container');
                  els.$cards = {
                      root: $cards,
                      headerIndexes: $cards.find('.js-iop-item-header'),
                      groupHeaders: $cards.find('.js-iop-index-header'),
                      items: $cards.find('.js-iop-item')
                  };
  
                  els.$collapsibleFirstSectionFiltersMobile = els.$root.find('.js-iop-hide-first-section-filters-mobile');
                  els.$collapsibleSecondSectionFiltersMobile  = els.$root.find('.js-iop-filter__second-section');
                  els.$collapseButton = els.$root.find('.js-iop-collapse-btn');
  
                  els.$calendarFields = els.$root.find('.js-iop-calendar');
  
                  els.resultsNumber = els.$root.find('.js-iop-results-number');
                  els.resetButton = els.$root.find('.js-iop-reset-button');
  
                  els.pagination = els.$root.find('.js-iop-filter-pagination');//odx-topic-hub-filter__pagination
                  els.anchorPagination = els.$root.find('.js-iop-filter-pagination a');
                  els.visibleItems = $cards.find('.js-iop-item--visible'); //.iop-filter__item--visible
                  els.visibleGroupHeaders = $cards.find('.js-iop-index-header--visible');
                  els.noResultsImage = els.$root.find('.js-iop-image-no-results');//odx-events__img-no-results
  
              },
              setPagination: function(){
                  var _this = this;
                  var els = this.elements;
  
                  var $allItems = els.$cards.items;
                  var $allHeaders = els.$cards.groupHeaders;
                  var $visibleItems = $('.js-iop-items-container .js-iop-item--visible');//els.visibleItems;
                  var visibleItemsNumber = $visibleItems.length;
                  var $pagination = els.pagination;
  
                  var elementsPerPage = this.WidgetSettings.elementsPerPage;
  
                  var samePage = 0;
                  var itemInSamePage = 1;
                  var resetVariable = 0;
  
                  $allHeaders.attr('data-page', '');
                  $allItems.attr('data-page', '');
                  $allItems.attr('data-column', '');
  
                  $visibleItems.each(function (index) {
                      var $item = $(this);
                      index++;
                      var page = Math.ceil(index / elementsPerPage);
                      $item.attr('data-page', page);
  
                      if ( page !== samePage ) {
                          $item.addClass( 'fist-item-in-page' );
                          samePage = page;
                      }
  
                      if ( itemInSamePage == elementsPerPage || $item[0] === $visibleItems.last()[0] ) {
                          $item.addClass( 'last-item-in-page' );
                          itemInSamePage = resetVariable;
                      }
  
                      itemInSamePage++;
  
                      if( $item.attr('data-first-item') ) {
                          var keyHeader = $item.attr('data-first-item');
                          var header = els.$cards.root.find('.' + keyHeader);//$("h3."+keyHeader);
                          header.attr('data-page', page);
  
                      }
  
                  });
  
                  $pagination.twbsPagination('destroy');
  
                  var $noResults = els.noResultsImage;
                  $noResults.hide();
                  if (visibleItemsNumber <= 0) {
                      $noResults.show();
                      $allHeaders.hide();
                      return;
                  }
  
                  if ( $allItems.length <= elementsPerPage ) {
                      $pagination.addClass( 'hidden' );
                  }
  
                  $pagination.twbsPagination({
                      totalPages: Math.ceil(visibleItemsNumber / elementsPerPage),
                      visiblePages: 7,
                      first: null,
                      prev: '<i class="fa fa-caret-left"></i>',
                      next: '<i class="fa fa-caret-right"></i>',
                      last: null,
                      onPageClick: function (event, page) {
                          _this.paginateResults(page);
                      }
                  });
  
                  var $pages = $pagination.find('.page-link');
                  $pages.each(function(){
                      var $page = $(this);
                      var pageNumber = $page.text();
                      $page.attr('aria-label',"Page Number "+pageNumber);
                  });
  
                  $pages.first().attr('aria-label',"Previous page");
                  $pages.last().attr('aria-label',"Next page");
  
                  var $anchorPagination = els.anchorPagination;
                  $anchorPagination.attr('aria-label', 'resources-search-pagination');
                  $anchorPagination.attr('href', '#top');
              },
              paginateResults: function(page) {
                  var _this = this;
                  var els = this.elements;
                  var cardsContainer = els.$cards.root;
                  var visibleItems = els.visibleItems;
                  var headers = els.visibleGroupHeaders;
  
                  visibleItems.hide();
                  headers.hide();
  
                  //Show card per page number assigned
                  var itemInPage = cardsContainer.find('.js-iop-item--visible[data-page="'+page+'"]');
                  itemInPage.show();
  
                  //Show index header per page number assigned
                  var headerInPage = cardsContainer.find('.js-iop-index-header[data-page="' + page + '"]');
                  headerInPage.show();
  
                  this.removeAriaAttributesFromItemsDisplayed();
                  this.focusFirstItemAfterPagination( itemInPage );
  
                  var $activePage = els.pagination.find('.page-item.active');
                  $activePage.on('click', function() {
                      _this.focusFirstItemAfterPagination( itemInPage );
                  });
  
              },
              removeAriaAttributesFromItemsDisplayed: function(){
                  //Accessibility
                  var els = this.elements;
                  var $items = els.$cards.items;
  
                  $items.each( function() {
                      this.removeAttribute('tabindex');
                      this.removeAttribute('aria-hidden');
                  } );
              },
              focusFirstItemAfterPagination: function( $items ){
                  //Accessibility
                  if ( $items.length > 0 ) {
                      $items[0].setAttribute('tabindex', '0');
                      $items[0].setAttribute('aria-hidden', 'false');
                      $items[0].focus();
                  }
              },
              updateOtherFiltersClicked: function( reset ){
                  if ( reset && reset === true ) {
                      this.OtherFiltersClicked = 0;
                  } else  {
                      this.OtherFiltersClicked++;
                  }
              },
              updateFiltersInDropdownClicked: function( category, values ){
                  var _this = this;
                  if ( this.FiltersInDropdownClicked.length === 0 ) {
                      var valueFromDropdownSelected = {
                          name: category,
                          value: values
                      };
                      this.FiltersInDropdownClicked.push(valueFromDropdownSelected);
                  } else {
                      for( var i = 0; i < this.FiltersInDropdownClicked.length; i++ ) {
                          if ( this.FiltersInDropdownClicked[i].name === category ) {
                              this.FiltersInDropdownClicked[i].value = values;
                              break;
                          }
  
                          if ( this.FiltersInDropdownClicked[i].name !== category && i === this.FiltersInDropdownClicked.length - 1 ) {
                              var valueFromDropdownSelected = {
                                  name: category,
                                  value: values
                              };
                              this.FiltersInDropdownClicked.push(valueFromDropdownSelected);
                          }
                      }
                  }
              },
              updateSortingOptionsSelected: function( SelectorId, SortItem, propertyName ){//Insert or remove to the array, the Sorting function clicked by the user
  
                  var sortingFunction;
  
                  if ( SortItem.hasOwnProperty('sortFn') && SortItem.sortFn !== undefined ) {
                      sortingFunction = SortItem.sortFn;
                  } else if ( SortItem.hasOwnProperty('order') ) {
                      //Add sorting methods
                      sortingFunction = this.addDefaultSortingFunction( SortItem, propertyName );
                  }
  
                  //Search to include or remove SortingClicked
  
                  if ( this.SortingClicked.length === 0 ) {
                      var SortMethod = {
                          name: SelectorId,
                          sortInst: sortingFunction
                      };
                      this.SortingClicked.push(SortMethod);
                  } else {
                      for( var i = 0; i < this.SortingClicked.length; i++ ) {
                          //If I've found the item then I remove it
                          if ( this.SortingClicked[i].name === SelectorId ) {
                              this.SortingClicked.splice( i, 1 );
                              break;
                          }
  
                          //If last element and item was not found, then I add it
                          if (  this.SortingClicked[i].name !== SelectorId && this.SortingClicked.length - 1 === i ) {
  
                              var SortMethod = {
                                  name: SelectorId,
                                  sortInst: sortingFunction
                              };
  
                              this.SortingClicked.push( SortMethod );
                          }
                      }
                  }
  
                  // this.SortingClicked updated
              },
              addDefaultSortingFunction: function( SortItem, propertyName ){
  
                  var ascendingOrDescendigSortFunction;
  
                  if ( SortItem.order.toUpperCase() === "ASC" ) {
  
                      ascendingOrDescendigSortFunction = function( ItemsToSort ) {
                          ItemsToSort.sort( function( a, b ) {
                              var propertyItemA = a[propertyName];
                              var propertyItemB = b[propertyName];
                              return propertyItemA.localeCompare( propertyItemB );
                          } );
  
                          return ItemsToSort;
                      };
                  }
  
                  if ( SortItem.order.toUpperCase() === "DESC" ) {
  
                      ascendingOrDescendigSortFunction = function( ItemsToSort ) {
                          ItemsToSort.sort( function( a, b ) {
                              var propertyItemA = a[propertyName];
                              var propertyItemB = b[propertyName];
                              return propertyItemB.localeCompare( propertyItemA );
                          } );
  
                          return ItemsToSort;
                      };
                  }
  
                  return ascendingOrDescendigSortFunction;
              },
              allCategoriesFrom: function( taxonomy ){
  
                  var allOptions;
  
                  for ( var i = 0; i < this.Filters.length; i++ ) {
                      if ( this.Filters[i].propertyName === taxonomy ) {
                          allOptions = this.Filters[i].options;
                      }
                  }
  
                  if ( allOptions[0] === "all" )
                      allOptions.splice(0, 1);
  
                  return allOptions;
              },
              addPropertiesToFiltersForTemplate: function( Filters ){
                  //Infer number of columns for Bootstrap and get options from content if not specified in the FILTER
                  var ProcessedFilters = MultipleFiltersDataLogic.preProcessFilters( Filters );
                  return ProcessedFilters;
              },
              hideAllCards: function(){
                  var els = this.elements;
                  var $cards = els.$cards.items;
  
                  var numberOfCards = $cards.length;
  
                  for ( var i=0; i < numberOfCards; i++ ) {
                      $( $cards[i] ).hide();
                      $( $cards[i] ).removeClass('js-iop-item--visible');
                  }
  
              },
              hideGroupHeaders: function(){
                  var els = this.elements;
                  els.$cards.groupHeaders.each(function(){
                      var $header = $(this);
                      $header.hide();
                  });
              },
              showCards: function( uuidsToMap ){
                  var els = this.elements;
                  var $cards = els.$cards.items;
  
                  this.hideAllCards();
                  uuidsToMap.forEach( function( uuid ) {
                      var numberOfCards = $cards.length;
  
                      for ( var i=0; i < numberOfCards; i++ ) {
                          if ( uuid === $cards[i].id ) {
                              $( $cards[i] ).show();
                              if ( ! $( $cards[i] ).hasClass('js-iop-item--visible') )
                                  $( $cards[i] ).addClass('js-iop-item--visible');
                          }
                      }
                  } );
              },
              showAllHeaders: function(){
                  var els = this.elements;
                  els.$cards.groupHeaders.each(function(){
                      var $header = $(this);
                      $header.show();
                      $header.addClass('js-iop-index-header--visible');
                  });
              },
              renderShowResults: function( numberResults ) {
                  var els = this.elements;
                  var resultsParagraph = els.resultsNumber;
                  //var filterShowing = OHIO.Utils.actions.getMultilingualLabelByWCMKey('odx-filter-showing');
                  //var results = OHIO.Utils.actions.getMultilingualLabelByWCMKey('odx-results');
  
                  resultsParagraph.text(OHIO.Utils.actions.getMultilingualLabelByWCMKey('odx-found') + ' '  + numberResults + ' ' + OHIO.Utils.actions.getMultilingualLabelByWCMKey('odx-results'));
                  this.focusResults();
              },
              setListenerForDropdown: function( idFilter, taxonomy ){
                  var _this = this;
  
                  //validate if filter exist or keywordOnly
                  if (idFilter) {
                      var id = idFilter.substr(0,1) === '#' ? idFilter : "#" + idFilter;
  
                      $( id ).select2().on('change', function( event ) {
                          event.preventDefault();
                          var categoriesSelectedFromDropdown = $(this).val();
                          var lastCategorySelected = $('span.select2-selection[aria-owns="select2-js-select-' + taxonomy + '-results"]');
                          var numberOfSelectedCategories = 0;
  
                          if (categoriesSelectedFromDropdown !== null) {
                              numberOfSelectedCategories = categoriesSelectedFromDropdown.length;
                          }
  
                          if (lastCategorySelected.length > 0) {
                              lastCategorySelected = lastCategorySelected[0].getAttribute('aria-activedescendant').split('-').pop();
                          } else if (numberOfSelectedCategories === 0) {
                              categoriesSelectedFromDropdown = [];
                              categoriesSelectedFromDropdown[0] = 'all';
                              lastCategorySelected = 'all';
                          }
  
                          if (lastCategorySelected === 'all') {
                              categoriesSelectedFromDropdown = [];
                              categoriesSelectedFromDropdown[0] = 'all';
                              $( id ).val(categoriesSelectedFromDropdown).trigger('change.select2');
                          } else {
                              if (categoriesSelectedFromDropdown !== null && categoriesSelectedFromDropdown[0] === 'all' && ( numberOfSelectedCategories > 1 )) {
                                  categoriesSelectedFromDropdown.splice(0, 1);
                                  $( id ).val(categoriesSelectedFromDropdown).trigger('change.select2');
                              }
                          }
  
                          var filterAll = false;
  
                          //Fix when removing more than 2 box and input left empty
                          if ( categoriesSelectedFromDropdown === null ) {
                              categoriesSelectedFromDropdown = [];
                              categoriesSelectedFromDropdown.push('all');
                              $( id ).val(categoriesSelectedFromDropdown).trigger('change.select2');
                          }
  
                          for (var i=0; i<categoriesSelectedFromDropdown.length; i++){
                              if (categoriesSelectedFromDropdown[i] === "all") {
                                  filterAll = true;
                                  break;
                              }
                          }
  
                          if (filterAll) {
                              categoriesSelectedFromDropdown =_this.allCategoriesFrom( taxonomy );
                          }
  
                          _this.updateFiltersInDropdownClicked( taxonomy, categoriesSelectedFromDropdown );
  
                          var FilteredItems;
  
                          var otherFiltersClicked = false;
                          var isKeywordInputFilled = _this.getKeyword();
                          if ( isKeywordInputFilled !== '' ) {
                              _this.updateOtherFiltersClicked();
                          }
  
                          if ( _this.OtherFiltersClicked > 0 ) {
                              otherFiltersClicked = true;
                              FilteredItems = MultipleFiltersDataLogic.filterAction( _this.FiltersInDropdownClicked, otherFiltersClicked );
                              FilteredItems = _this.applyOtherFilters( FilteredItems );
  
                          } else  {
                              //Return Items completed
                              FilteredItems = MultipleFiltersDataLogic.filterAction( _this.FiltersInDropdownClicked );
                          }
  
  
                          var isAnySortingActive = _this.SortingClicked.length > 0;
  
                          if ( isAnySortingActive ) {
                              FilteredItems = MultipleFiltersDataLogic.sortAction( _this.SortingClicked );
                          }
  
                          var uuidsToMap = FilteredItems.map( function( Item ) {
                              return Item.uuid;
                          } );
  
                          var numberOfResults = uuidsToMap.length;
  
                          _this.showCards( uuidsToMap );
                          _this.renderShowResults( numberOfResults );
                          _this.setPagination();
  
                          var hashParam = _this.getHashParameters();
                          hashParam[ taxonomy ] = categoriesSelectedFromDropdown.join( ',' );
                          _this.setHashParameters( hashParam );
  
                          _this.updateOtherFiltersClicked();
  
                          /*
                          if ( removedAllCategoriesFromBox && isAnySortingActive ) {
                              _this.renderCards( FilteredItems );
                              _this.renderShowResults( numberOfResults );
                          } else {
                              _this.showCards( uuidsToMap );
                              _this.renderShowResults( numberOfResults );
                              _this.setPagination();
                          }
                          */
                          _this.focusResults();
                      });
                  } else {
                      //for keywordOnly
                      $('#iop-filter-taxonomies-container').hide();
                  }
              },
              setListenerForSorting: function( sortingSelector, propertyName, SortObject ){
  
                  var _this = this;
                  var SortedItems = [];
                  var FilteredItems = [];
                  var SortObj = SortObject;
  
                  $( sortingSelector ).on( "click", function(){
                      _this.updateSortingOptionsSelected( sortingSelector, SortObj, propertyName );//Update sort function for filtering global variable
                      var sortAllItems = true; //To render all and not just those from last filtered applied
                      SortedItems = MultipleFiltersDataLogic.sortAction( _this.SortingClicked, sortAllItems );
  
                      var filteredWasApplied = _this.FiltersInDropdownClicked.length > 0;
  
                      var deferred = $.Deferred();
                      _this.renderCards( SortedItems, deferred ).done( function(){
  
                          var uuidsToMap = [];
  
                          if ( filteredWasApplied ) {
                              FilteredItems = MultipleFiltersDataLogic.filterAction( _this.FiltersInDropdownClicked );
                              uuidsToMap = FilteredItems.map( function( el ) {
                                  return el.uuid;
                              } );
  
                              var numberOfResults = uuidsToMap.length;
                              _this.showCards( uuidsToMap );
                              _this.renderShowResults( numberOfResults );
                              //_this.setPagination();
  
                          }
  
                      } );
  
                      //_this.renderShowResults( numberOfResults );
                      //_this.renderCards( FilteredItems );
  
                  } );
  
              },
              setListenerForInput: function(){
  
                  var els = this.elements;
                  var searchButton = els.searchButton;
                  var input = els.input;
  
                  input.on('keypress', function( event ){
                      var keyCode = event.which;
                      if (keyCode == 13) {
                          searchButton.trigger('click');
                      }
                  });
  
              },
              setListenerForDateFilter: function( EventFilter ){
                  var _this = this;
  
                  var startTimeSelector = EventFilter.startTimeSelector;
                  var endTimeSelector = EventFilter.endTimeSelector;
  
                  $('#' + startTimeSelector ).on('change', function(){
                      _this.focusFieldDate( 'endField' );
                      _this.updateOtherFiltersClicked();
                  });
                  $('#' + endTimeSelector ).on('change', function(){
                      var valueStartDate = _this.getFromDate();
                      var valueEndDate = _this.getToDate();
                      if ( valueStartDate == undefined || valueStartDate == '' )
                          _this.focusFieldDate( 'startField' );
  
                      if ( valueStartDate > valueEndDate ) {
                          _this.focusFieldDate( 'startField' );
                      }
                      _this.updateOtherFiltersClicked();
                  });
  
              },
              triggerFilterByDate: function( EventFilter, useBootstrapDatePicker ){
  
                  var _this = this;
  
                  var startTimeSelector = EventFilter.startTimeSelector;
                  var endTimeSelector = EventFilter.endTimeSelector;
  
                  var startTimeInput;
                  var endTimeInput;
  
                  if ( useBootstrapDatePicker  ) {
                      /* get from Datepicker bootstrap inputs */
                      startTimeInput = $( '#' + startTimeSelector + '.datepicker' ).val();
                      endTimeInput = $( '#' + endTimeSelector + '.datepicker' ).val();
                  } else {
                      /* get from formio inputs */
                      startTimeInput = $( startTimeSelector + ' .flatpickr-input' ).val();
                      endTimeInput = $( endTimeSelector + ' .flatpickr-input' ).val();
                  }
  
                  if ( startTimeInput != '') {
                      startTimeInput = new Date ( startTimeInput + ' 00:00:00 AM' ) || '';
                  } else {
                      startTimeInput = '';
                  }
                  if ( endTimeInput != '') {
                      endTimeInput = new Date ( endTimeInput + ' 11:59:59 PM' ) || '';
                  } else {
                      endTimeInput = '';
                  }
  
                  var hasAnyFilterBeingApplied = _this.FiltersInDropdownClicked.length;
  
                  var FilteredItems = [];
  
                  if ( startTimeInput != '' ) {
                      if ( hasAnyFilterBeingApplied === 0 && _this.OtherFiltersClicked === 0 ) {
                          var noFiltersApplied = true;
                          FilteredItems = MultipleFiltersDataLogic.filterByDate( startTimeInput, endTimeInput, noFiltersApplied );
  
                      } else {
                          //MultipleFiltersDataLogic.filterAction( _this.FiltersInDropdownClicked );
                          FilteredItems = MultipleFiltersDataLogic.filterByDate( startTimeInput, endTimeInput );
                          FilteredItems = _this.applyOtherFilters( FilteredItems );
                      }
                  }
  
                  return FilteredItems;
              },
              setListenerCustom: function( id, eventName, filterFn, urlParam ){
                  var _this = this;
                  $( id ).on( eventName, function( event ) {
                      //event.preventDefault();
  
                      console.log("Click custom");
                      var FilteredItems;
  
                      if ( _this.OtherFiltersClicked > 0 ) {
                          FilteredItems = MultipleFiltersDataLogic.filterCustom( filterFn );
                          FilteredItems = _this.applyOtherFilters( FilteredItems );
  
                      } else  {
                          //Return Items completed
                          FilteredItems = MultipleFiltersDataLogic.filterCustom( filterFn );
                      }
  
  
                      var uuidsToMap = FilteredItems.map( function( el ) {
                          return el.uuid;
                      } );
  
                      var numberOfResults = uuidsToMap.length;
  
                      var deferred = $.Deferred();
                      _this.renderCards( FilteredItems, deferred ).done( function() {
                          _this.renderShowResults( numberOfResults );
                          //_this.setPagination();
                      } );
  
                      //_this.renderShowResults( numberOfResults );
                      //_this.showCards( uuidsToMap );
                      //_this.setPagination();
                      var hashParam = _this.getHashParameters();
                      hashParam[ urlParam ] = 'value X';
                      _this.setHashParameters( hashParam );
                      _this.updateOtherFiltersClicked();
  
                  } );
              },
              setListenerSearchButton: function( EventFilter, useBootstrapDatePicker ){
                  var _this = this;
  
                  var els = this.elements;
                  var searchButton = els.searchButton;
  
                  var calendarFieldsEnabled = _this.FilterInitialSettings.events !== undefined ? true : false ;
  
                  searchButton.on('click', function(){
                      var keyword = _this.getKeyword();
  
                      var hasAnyFilterBeingApplied = _this.FiltersInDropdownClicked.length;
  
                      var FilteredItems = [];
                      var noFiltersApplied;
                      var atLeastASingleTagFromDropdownClicked = _this.FiltersInDropdownClicked.length;
  
                      if ( hasAnyFilterBeingApplied === 0 && _this.OtherFiltersClicked == 0 ) {
                          noFiltersApplied = true;
                          FilteredItems = MultipleFiltersDataLogic.filterByKeyword( keyword, _this.Filters, noFiltersApplied );
                      } else {
                          if ( atLeastASingleTagFromDropdownClicked > 0 )
                              FilteredItems = MultipleFiltersDataLogic.filterAction( _this.FiltersInDropdownClicked );
                          FilteredItems = MultipleFiltersDataLogic.filterByKeyword( keyword, _this.Filters );
                      }
  
  
  
                      if ( calendarFieldsEnabled && _this.calendarFieldsAreFilled() ) {
                          if ( atLeastASingleTagFromDropdownClicked == 0 ) {
                              var reset = true;
                              _this.updateOtherFiltersClicked( reset )
                          }
                          FilteredItems = _this.triggerFilterByDate( EventFilter, useBootstrapDatePicker );
                      }
                      /* else {
                          if ( keyword == '' || _this.OtherFiltersClicked > 0 ) {
                              if ( keyword !== '' && ( _this.getFromDate() == '' || _this.getFromDate() == undefined ) ) {
                                  _this.focusFieldDate( 'startField' );
                              }
  
                              if ( keyword !== '' && ( _this.getToDate() == '' || _this.getToDate() == undefined ) ) {
                                  _this.focusFieldDate( 'endField' );
                              }
                          }
                      }
                  */
  
  
                      var uuidsToMap = FilteredItems.map( function( el ) {
                          return el.uuid;
                      } );
  
                      var numberOfResults = uuidsToMap.length;
  
                      _this.renderShowResults( numberOfResults );
                      _this.showCards( uuidsToMap );
                      _this.setPagination();
  
                  });
  
              },
              calendarFieldsAreFilled: function(){
                  var startTimeInput = this.getFromDate();
                  var endTimeInput = this.getToDate();
  
                  if ( startTimeInput !== undefined && endTimeInput !== undefined ) {
                      if ( startTimeInput !== '' && endTimeInput !== '' )
                          return true;
                  }
  
                  return false;
              },
              focusFieldDate: function( $field ){
                  var els = this.elements;
                  var datePickerWrapper = els.$calendarFields;
                  var $inputStartDate = datePickerWrapper.find('#js-start-time.datepicker');
                  var $inputEndDate = datePickerWrapper.find('#js-end-time.datepicker');
  
                  if ( $field == 'startField' ) {
                      $inputStartDate.focus();
                  }
  
                  if ( $field == 'endField' ) {
                      $inputEndDate.focus();
                  }
              },
              setListenerCollapseFiltersWhenMobile: function(){
  
                  var els = this.elements;
                  var $collapseButton = els.$collapseButton;
                  var $containerFiltersFirstSection = els.$collapsibleFirstSectionFiltersMobile;
                  var $containerFiltersSecondSection = els.$collapsibleSecondSectionFiltersMobile;
  
                  $collapseButton.on('click', function( event ){
                      var $iconArrow = $collapseButton.find('i');
                      if ( $containerFiltersFirstSection.css('display') !== 'none' ) {
                          //If visible then Hide
                          $iconArrow.toggleClass('fa-chevron-up');
                          $iconArrow.toggleClass('fa-chevron-down');
                          $containerFiltersFirstSection.hide();
                          $containerFiltersSecondSection.hide();
                      } else {
                          //If hidden then show
                          $iconArrow.toggleClass('fa-chevron-down');
                          $iconArrow.toggleClass('fa-chevron-up');
                          $containerFiltersFirstSection.show();
                          $containerFiltersSecondSection.show();
                      }
                  });
  
              },
              focusResults: function(){
                  var els = this.elements;
                  var $resultsParagraph = els.resultsNumber;
                  $resultsParagraph.focus();
              },
              getHashParameters: function(){
                  var hash = window.location.href.split( "#" );
                  hash = hash[ 1 ] ? hash[ 1 ] : "";
                  var hashParameters = '';
                  hashParameters = hash.split( '&' ).reduce( function( hashParameters, item ) {
                      var parts = item.split( '=' );
                      hashParameters[ parts[ 0 ] ] = decodeURI( parts[ 1 ] );
                      return hashParameters;
                  }, {} );
                  return hashParameters;
              },
              setHashParameters: function( params ){
                  params = params || {};
                  params.page = params.page || 1;
                  var stringParameters = [];
  
                  for( var param in params ) {
                      if( ! params.hasOwnProperty( param ) ) continue;
                      if( param && params[ param ] ) stringParameters.push( param + "=" + params[ param ] );
                  }
  
                  stringParameters = stringParameters.length > 0 ? '#' + stringParameters.join( "&" ) : "";
  
                  window.location.href = window.location.href.split( '#' )[ 0 ] + stringParameters;
              },
              addingAriaLabels: function(){
                  $(".select2-search__field").attr("aria-label", function () {
                      return $(this).closest("article").attr("id")
                  });
              },
              setResetActions: function(){
  
                  var _this = this;
  
                  var els = this.elements;
                  var resetButton = els.resetButton;
  
                  resetButton.on('click', function(){
                      console.log("RESET button");
                      _this.resetAll();
                  });
              },
              resetAll: function(){
                  var _this = this;
                  var els = this.elements;
                  var allResultsNumber;
                  var inputBox = els.input;
  
                  inputBox.val('');
  
                  var categoriesId = this.Filters.map( function( Filter ) {
                      return Filter.id;
                  } );
  
                  //for keywordOnly
                  if (categoriesId[0] != undefined) {
                      categoriesId.forEach( function( idFilter ) {
                          var id = idFilter.substr(0,1) === '#' ? idFilter : "#" + idFilter;
                          $( id ).val( ["all"] ).trigger( 'change.select2' );
                      } );
                  }
  
                  if ( this.FilterInitialSettings.hasOwnProperty('sorting')  ) {
                      this.FilterInitialSettings.sorting.forEach( function( Sort ) {
                          _this.updateSortingOptionsSelected( Sort.id, Sort );
                      } );
                  }
  
                  if ( this.FilterInitialSettings.hasOwnProperty('events')  ) {
                      var $startTime;
                      var $endTime;
                      if ( this.FilterInitialSettings.events.startTimeSelector ) {
                          $startTime = els.$root.find('#' + this.FilterInitialSettings.events.startTimeSelector );
                          $startTime.val('');
                      }
  
                      if ( this.FilterInitialSettings.events.endTimeSelector ) {
                          $endTime = els.$root.find('#' + this.FilterInitialSettings.events.endTimeSelector );
                          $endTime.val('');
                      }
                  }
  
                  //Return Items completed
                  //var FilteredItems = MultipleFiltersDataLogic.filterAction( this.FiltersInDropdownClicked );
                  var FilteredItems = MultipleFiltersDataLogic.resetFilters();
                  this.FiltersInDropdownClicked.splice(0);
                  this.SortingClicked.splice(0);
  
                  /*
                  if ( this.SortingClicked.length > 0 ) {
                      FilteredItems = MultipleFiltersDataLogic.sortAction( this.SortingClicked );
                  }
                   */
  
                  var uuidsToMap = FilteredItems.map( function( el ) {
                      return el.uuid;
                  } );
  
                  //To render all cards and not just the few results from last sorting
                  if ( uuidsToMap.length === this.totalResources ) {
                      var deferred = $.Deferred();
                      this.renderCards( FilteredItems, deferred ).done( function(  ) {
                          allResultsNumber = _this.totalResources;
  
                          _this.renderShowResults( allResultsNumber );
                          //_this.setPagination();
                      } );
                  }
  
                  this.setHashParameters( {} );
                  var reset = true;
                  this.updateOtherFiltersClicked( reset );
  
              },
              buildFieldsForBootstrapDatePicker: function(){
  
                  $('.datepicker').datepicker( {
                      autoclose: true,
                      orientation: 'bottom',
                      ignoreReadonly: true,
                      disableTouchKeyboard: true
                  } ).on('changeDate', function (e) {
                      if (e.target.name === 'date-range-from') {
                          //eventsFilter.setFromDate(e.date);
                      } else if (e.target.name === 'date-range-to') {
                          //eventsFilter.setToDate(e.date);
                      }
  
                  });
              },
              getFromDate: function(){
                  var els = this.elements,
                      datePickerWrapper = els.$calendarFields,
                      inputStartDate = datePickerWrapper.find( '#js-start-time.datepicker' ),
                      startDateInputFormatted;
                  if ( inputStartDate && inputStartDate.val() !== undefined && inputStartDate.val() !== "" ) {
                      startDateInputFormatted = new Date ( inputStartDate.val() ) || '';
                      return startDateInputFormatted;
                  }
                  return undefined;
              },
              getToDate: function(){
                  var els = this.elements,
                      datePickerWrapper = els.$calendarFields,
                      inputEndDate = datePickerWrapper.find( '#js-end-time.datepicker' ),
                      endDateInputFormatted;
                  if ( inputEndDate && inputEndDate.val() !== undefined && inputEndDate.val() !== "" ) {
                      endDateInputFormatted = new Date ( inputEndDate.val() ) || '';
                      return endDateInputFormatted;
                  }
                  return undefined;
              },
              getKeyword: function(){
                  var els = this.elements;
                      input = els.input,
                      keyword = input.val(),
                      valueKeyword = keyword.trim().toLowerCase();
                  return valueKeyword;
              },
              applyOtherFilters: function( FilteredItems ){
                  var startDateInput = this.getFromDate();
                  var endDateInput = this.getToDate();
  
                  if ( startDateInput !== undefined || endDateInput !== undefined ) {
                      FilteredItems= MultipleFiltersDataLogic.filterByDate( startDateInput, endDateInput );
                  }
  
                  var keywordInput = this.getKeyword();
  
                  if ( keywordInput ) {
                      FilteredItems = MultipleFiltersDataLogic.filterByKeyword( keywordInput, this.Filters );
                  }
  
                  return FilteredItems;
              },
              buildFieldsForEventPicker: function( EventFilter ){
                  if ( EventFilter.hasOwnProperty('id') && EventFilter.id !== undefined ) {
                      var id = EventFilter.id.substr(0,1) === '#' ? EventFilter.id.substr(1) : EventFilter.id;
                      this.getForm( EventFilter.formName, id );
                  } else {
                      this.getForm( EventFilter.formName, "calendar-field" );
                  }
              },
              getForm: function( formName, container ){
                  // 1) Render the instance of Formio
  
                  var formURL = global.formioBaseURL + '/' + global.formioProject + '/' + formName;
  
                  try {
                      FormioInstance.createForm(document.getElementById(container), formURL, {
                          hooks: {
                              beforeSubmit: function(submission, next) {
                                  // Alter the submission
                                  // Only call next when we are ready to submit
                                  console.log(submission.data);
                                  next();
                                  console.log('Current State: Before Summit');
                              }
                          }
                      }).then(function(form) {
                          // Adding required structure to wrap the email validation control
                          form.nosubmit = true;
  
                          form.on('submit', function(submission) {
                              console.log('Current State:  Sbmitted!');
                              //console.log(submission.data);
                          });
                      });
                  } catch( e ) {
                      console.error( "ID for event picker was not found in the template or div" );
                      console.error( e );
                  }
              },
              renderComponent: function( deferredStart, elasticSearchQuery ){
                  var _this = this;
  
                  var mappingFunction;
  
                  if ( this.FilterInitialSettings.hasOwnProperty('itemsMapping') && typeof this.FilterInitialSettings.itemsMapping === "function" ) {
                      mappingFunction = this.FilterInitialSettings.itemsMapping;
                  }
  
                  var EventFilter = _this.FilterInitialSettings.events;
                  var sortByDate = typeof _this.FilterInitialSettings.sortByDate !== "undefined" ? _this.FilterInitialSettings.sortByDate : false;
  
                  if ( EventFilter && typeof _this.FilterInitialSettings.sortByDate === "undefined") {
                      sortByDate = true;
                  }
  
                  MultipleFiltersDataLogic.getContentPiecesData( mappingFunction, elasticSearchQuery, sortByDate ).then( function( response ){
                      console.log("Data: ", response );
  
                      var Filters = _this.FilterInitialSettings.filters;
                      var container = _this.WidgetSettings.root;
                      var template = _this.WidgetSettings.template;
                      var Sorting = _this.FilterInitialSettings.sorting;
                      var CustomFilters = _this.FilterInitialSettings.customFilter;
  
                      var Labels = _this.WidgetSettings.Labels;
                      if (Labels === undefined) {
                          Labels = {};
                          Labels.filterTitleFirstSection = undefined;
                          Labels.filterHelpText = undefined;
                          Labels.filterButton = undefined;
                          Labels.inputPlaceholder = undefined;
                          Labels.filterTitleSecondSection = undefined;
                          Labels.allTypeIndexButton = undefined;
                          Labels.resetFiltersButton = undefined;
                          Labels.shareTitle = undefined;
                          Labels.noResultsImageUrl = undefined;
                      }
  
                      _this.Filters = _this.addPropertiesToFiltersForTemplate( Filters );
                      _this.totalResources = response.length;
  
                      if ( Sorting ) {
                          for( var i=0; i<Sorting.length; i++ ) {
                              if ( Sorting[i].id.substr(0,1) === '#' ) {
                                  Sorting[i].id = Sorting[i].id.substr(1);
                              }
                          }
                      }
  
                      var FiltersComponent = new OhioToolkitWebComponent({
                          element: container, //'#id-container',
                          templateLocation: template,
                          data: {
                              Filters: _this.Filters,
                              sorting: Sorting,
                              eventFilter: EventFilter,
                              CustomFilter: CustomFilters,
                              filterTitleFirstSection: Labels.filterTitleFirstSection,
                              filterHelpText: Labels.filterHelpText,
                              filterButton: Labels.filterButton,
                              inputPlaceholder: Labels.inputPlaceholder,
                              filterTitleSecondSection: Labels.filterTitleSecondSection,
                              allTypeIndexButton: Labels.allTypeIndexButton,
                              resetFiltersButton: Labels.resetFiltersButton,
                              noResultsImageUrl: Labels.noResultsImageUrl
                          }
                      });
  
  
                      FiltersComponent.render().then(function() {
                          console.log('Filters Rendered');
  
                          //for keywordOnly
                          if (!_this.FilterInitialSettings.keywordOnly) {
                              _this.Filters.forEach( function( Filter ) {
                                  var categorySelector = Filter.id;
                                  var taxonomy = Filter.propertyName;
                                  _this.setListenerForDropdown( categorySelector, taxonomy );
                              } );
                          }
  
                          //validate if defined
                          if ( Sorting  ) {
                              Sorting.forEach( function( SortObject ) {
                                  var sortSelector = SortObject.id.substr(0,1) === '#' ? SortObject.id : "#" + SortObject.id;
                                  var propertyName = SortObject.propertyName;
                                  _this.setListenerForSorting( sortSelector, propertyName, SortObject );
                              } );
                          }
  
                          if ( CustomFilters ) {
                              CustomFilters.forEach( function( CstmFilter ) {
                                  _this.setListenerCustom( CstmFilter.id, CstmFilter.eventName, CstmFilter.filterFn, CstmFilter.urlParam );
                              } );
                          }
  
                          if ( EventFilter ) {//To render the events input at same time filters template do
                              if ( EventFilter.hasOwnProperty('formName') && EventFilter.formName !== undefined ) {
                                  _this.buildFieldsForEventPicker( EventFilter );
                              } else {
                                  _this.buildFieldsForBootstrapDatePicker();
                              }
                          }
  
                          var deferred = $.Deferred();
                          _this.renderCards( response, deferred ).done( function() {
                              //_this.setElements();
                              _this.setListenerForInput();
                              if ( EventFilter ) {//To add listener to events input once elements are rendered
                                  if ( EventFilter.hasOwnProperty('formName') && EventFilter.formName !== undefined ) {
                                      _this.setListenerForDateFilter( EventFilter );
                                      _this.setListenerSearchButton(  EventFilter );
                                  } else {
                                      var useBoostrapDatePicker = true;
                                      _this.setListenerForDateFilter( EventFilter );
                                      _this.setListenerSearchButton(  EventFilter, useBoostrapDatePicker  );
                                  }
                              } else {
                                  _this.setListenerSearchButton ( undefined )
                              }
  
                              _this.setResetActions();
                              //_this.setPagination();
  
                              //If URL parameters, filter with these parameters
                              var hashParameters = _this.getHashParameters();
                              if ( !hashParameters.hasOwnProperty("") ) {
                                  _this.Filters.forEach( function( _Filter ){
                                      var idForSelect2 = "#" + _Filter.id;
                                      var taxonomy = _Filter.propertyName;
                                      var urlQueryValue = hashParameters[ taxonomy ];
  
                                      if ( urlQueryValue !== undefined ) {
                                          var urlValues = urlQueryValue.split(",");
                                          //trigger filter
                                          $( idForSelect2 ).val( urlValues ).trigger('change');
                                      }
                                  } );
                              }
  
                              if (deferredStart)
                                  deferredStart.resolve();
  
                          } );
  
                          _this.addingAriaLabels();
  
                      });
  
                      //_this.renderCards( response );
  
                  });
  
                  if (deferredStart)
                      return deferredStart.promise();
                  return deferredStart;
              },
              renderCards: function( response, deferred ){
                  var _this = this;
                  var templateItems = _this.WidgetSettings.templateItems;
                  var imageNoResults = _this.WidgetSettings.imageNoResults;
                  var idTemplateItems = _this.WidgetSettings.idTemplateItems;
                  var noResultsText = _this.WidgetSettings.Labels.noResultsText;
                  var noResultsImageUrl = _this.WidgetSettings.Labels.noResultsImageUrl;
                  var shareTitle = _this.WidgetSettings.Labels.shareTitle;
  
                  var CardsComponent = new OhioToolkitWebComponent({
                      element: idTemplateItems,
                      templateLocation: templateItems,
                      data: {
                          items: response,
                          noResultsImgPath: imageNoResults,
                          noResultsText: noResultsText,
                          shareTitle: shareTitle,
                          noResultsImageUrl: noResultsImageUrl
                      }
                  });
  
                  CardsComponent.render().then( function() {
                      console.log("Results Rendered");
  
                      _this.setElements();
                      _this.setListenerCollapseFiltersWhenMobile();
                      _this.setPagination();
                      window.scrollTo(0, 0);
                      _this.removeAriaAttributesFromItemsDisplayed();
                      if (deferred)
                          deferred.resolve();
                  } );
  
                  if (deferred)
                      return deferred.promise();
                  return deferred;
              },
              start: function( Filters, WidgetSettings ) {
                  this.FilterInitialSettings = Filters;
                  this.WidgetSettings = WidgetSettings;
                  var deferred = $.Deferred();
                  return this.renderComponent( deferred, WidgetSettings.elasticSearchQuery ).done(function( response ) {
                      var promiseDef = $.Deferred();
                      deferred.resolve();
                      return deferred.promise();
                  });
              }
          };
  
          return Instance;
      };
  
  })();
  /* END: Ohio Design > Components > Site Builder > Site Components Core > Filter > Dependencies > JS - Content With Filters */
  
  var DEFAULT_WIDGET_SETTINGS = {
      root:               "#resources-filter",
      menuComponent:      'aa7a4aa9-f871-4f6e-a646-3b6a162a51dd',
      category:           '',
      template:           '/wps/wcm/connect/gov/3c7f54c8-4f05-484f-9134-b5f5b43ce4dc/standard-filter.hbs.html?MOD=AJPERES&amp;CACHEID=ROOTWORKSPACE.Z18_JQGCH4S04P41206HNUKVF31000-3c7f54c8-4f05-484f-9134-b5f5b43ce4dc-oyciScn',
      elementsPerPage:    12,
      idTemplateItems:    "#cards-generic-wrapper",
      imageNoResults:     '/wps/wcm/connect/gov/222eff35-ce11-4203-b24c-f8dc2e31e9d1/content-not-found_blue.png?MOD=AJPERES&amp;CACHEID=ROOTWORKSPACE.Z18_JQGCH4S04P41206HNUKVF31000-222eff35-ce11-4203-b24c-f8dc2e31e9d1-nFDz1TL',
      templateItems:      '/wps/wcm/connect/gov/6d2aee6f-851e-4c73-8881-2168abb1479b/resource-cards.hbs.html?MOD=AJPERES&amp;CACHEID=ROOTWORKSPACE.Z18_JQGCH4S04P41206HNUKVF31000-6d2aee6f-851e-4c73-8881-2168abb1479b-phcwUju',
      Labels: {
          filterHelpText: 'iop-filter-help-text',
          filterTitleFirstSection: 'iop-filter-input-title',
          inputPlaceholder: 'iop-filter-input-placeholder',
          filterButton: 'iop-filter-button-filter',
          resetFiltersButton: 'odx-filter-button-reset',
          noResultsText: 'iop-filter-no-results-txt'
      }
  };
  
  document.addEventListener('DOMContentLoaded', function() {
      //register handlebar helper by converting a string to an array and loop through
      Handlebars.registerHelper('eachFromString', function(value, options) {
          var data;
          var result = [];
          var arr = value.split(',');
          for (var i = 0; i < arr.length; i++) {
              if (data) {
                  data.index = i;
              }
              result.push(options.fn(arr[i]));
          }
          return result.join( '' );
      });
  
      //register handlebar helpber by checking summary length and add elipsis
      Handlebars.registerHelper('ellipsis', function( value ) {
          value = value.length >= 100 ? value + '...' : value;
          return value;
      });
  
      var dropdownsFilters = [{
          id:             "#js-select-categories", //Select2 Selector
          propertyName:   'topics', //Property to filter
          allLabel:       "odx-all-topics",
          label:          "iop-news-filter-by"
      }];
  
      if ( window.IOPFilter == undefined ) {
          window.IOPFilter = {};
      }
  
      if ( IOPFilter.hasOwnProperty( 'filters' ) ) {
          if ( Array.isArray(IOPFilter.filters) ) {
              dropdownsFilters = IOPFilter.filters;
          } else if ( !Array.isArray(IOPFilter.filters) && IOPFilter.filters.hasOwnProperty( 'propertyName' ) ) {
              dropdownsFilters = [{
                  id: "#js-select-categories", //Select2 Selector
                  propertyName: IOPFilter.filters.propertyName,
                  allLabel: "odx-all-topics",
                  label: "iop-news-filter-by" 
              }];
          }
      }
  
      //Default filters
      var FILTERS = {
          alpha: IOPFilter.alpha,
          filters: dropdownsFilters,
          sorting: IOPFilter.sorting,
          sortByDate: IOPFilter.sortByDate || false,
          events: {
              startTimeSelector: "js-start-time",
              endTimeSelector: "js-end-time",
              labelStart: 'iop-news-start-date',
              labelEnd: 'iop-news-end-date',
          },
          itemsMapping: IOPFilter.itemsMapping,
          customFilter: IOPFilter.customFilter
      };
  
      /* Hide dropdowns if IOPFilter.filters = false */
      if ( IOPFilter.hasOwnProperty( 'showDropdown' ) && IOPFilter.showDropdown == false ) {
          FILTERS.filters = [];
      }
  
      /* Hide datepicker if IOPFilter.events = false */
      if ( IOPFilter.hasOwnProperty( 'showDatePicker' ) && IOPFilter.showDatePicker == false ) {
          delete FILTERS.events;
      } else {
          /* Overwrite datepicker if IOPFilter.events receives an object */
          FILTERS.events = IOPFilter.hasOwnProperty( 'events' ) ? IOPFilter.events : FILTERS.events;
      }
  
      /* =========== START Remove undefined filters to avoid crash in the JS =========== */
  
      if ( FILTERS.alpha == undefined ) {
          delete FILTERS.alpha;
      }
  
      if ( FILTERS.sorting == undefined ) {
          delete FILTERS.sorting;
      }
  
      if ( FILTERS.itemsMapping == undefined ) {
          delete FILTERS.itemsMapping;
      }
  
      if ( FILTERS.customFilter == undefined ) {
          delete FILTERS.customFilter;
      }
  
      /* =========== END Remove undefined filters to avoid crash in the JS =========== */
  
      var WIDGET_SETTINGS = {
          wcmComponent: {
              id:         IOPFilter.menuComponent || DEFAULT_WIDGET_SETTINGS.menuComponent,
              category:   IOPFilter.category || DEFAULT_WIDGET_SETTINGS.category
          },
          elasticSearchQuery: IOPFilter.elasticSearchQuery || false,
          root:               IOPFilter.root || DEFAULT_WIDGET_SETTINGS.root,
          template :          IOPFilter.template || DEFAULT_WIDGET_SETTINGS.template,
          elementsPerPage:    IOPFilter.elementsPerPage || DEFAULT_WIDGET_SETTINGS.elementsPerPage,
          idTemplateItems:    IOPFilter.idTemplateItems || DEFAULT_WIDGET_SETTINGS.idTemplateItems,
          imageNoResults:     IOPFilter.imageNoResults || DEFAULT_WIDGET_SETTINGS.imageNoResults,
          templateItems:      IOPFilter.templateItems || DEFAULT_WIDGET_SETTINGS.templateItems,
          Labels:             IOPFilter.Labels || DEFAULT_WIDGET_SETTINGS.Labels
      };
  
      var multipleFiltersInstance = window.FiltersWidget( WIDGET_SETTINGS.wcmComponent );
      multipleFiltersInstance.start(FILTERS, WIDGET_SETTINGS).done(function( response ) {
  
          /* Hide input keyword if IOPFilter.keyword = false */
          if ( IOPFilter.hasOwnProperty( 'showKeyword' ) ) {
              if ( IOPFilter.hasOwnProperty( 'showKeyword' ) && IOPFilter.showKeyword == false ) {
                  var $inputKeyword = document.querySelector( '.js-iop-input' );
                  $inputKeyword.classList.add( "hidden" );
                  var $keywordContainer = $( '.js-iop-filter__first-section' );
                  $keywordContainer.hide();
  
                  var $secondSectionContainer = $( ".js-iop-filter__second-section" );
                  $secondSectionContainer.css('border-top', '1px solid #D8D8D8');
                  $secondSectionContainer.css('border-radius', '10px');
              }
          }
  
          /* Hide filters border if all filters disabled */
          if ( IOPFilter.showKeyword == false && IOPFilter.showDropdown == false && IOPFilter.showDatePicker == false ) {
              var $secondSectionContainer = $( ".js-iop-filter__second-section" );
              $secondSectionContainer.hide();
          }
  
          /* Run any function assigned to IOPFilter.executeAfterFilterRendered after widget has been rendered */
          if ( IOPFilter.hasOwnProperty( 'executeAfterFilterRendered' ) ) {
              IOPFilter.executeAfterFilterRendered();
          }
      
      });
  
  });
  
  /* ========= How to enable the rest of filters ======== */
  /* Assign each of the following variables according to documentation:
  var IOPFilter.alpha;
  var IOPFilter.sorting;
  var IOPFilter.itemsMapping;
  var IOPFilter.customFilter;
  var IOPFilter.executeAfterFilterRendered;
  */
  
  </script>
  
  <!-- END: Ohio Design / Site Builder / Site Components Core / Filter / Resources / MAIN - Configurable Resources Filter -->
  </section>